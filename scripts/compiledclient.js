!function(){"use strict";class t{constructor(){this.canvas=document.createElement("canvas"),this.canvas.id="Jacksnipe-Canvas",this.width=null,this.height=null}makeDisplay(t,s){this.width=t,this.height=s,this.canvas.width=t,this.canvas.height=s,window.ctx=this.canvas.getContext("2d"),window.canvas=this.canvas}static useDisplay(t){document.body.appendChild(t.canvas)}resizeDisplay(t,s){this.width=t,this.height=s,this.canvas.width=t,this.canvas.height=s}clearDisplay(){ctx.clearRect(0,0,this.width,this.height)}}class s{constructor(t,s,e,i,a){this.image=t,this.x=s,this.y=e,this.width=i,this.height=a}moveTo(t,s){this.x=t,this.y=s}resize(t,s){this.width=t,this.height=s}}class e{constructor(t,s,e,i){this.x=t,this.y=s,this.width=e,this.height=i}static doRectsCollide(t,s){return t.x<s.x+s.width&&s.x<t.x+t.width&&t.y<s.y+s.height&&s.y<t.y+t.height}static areCoordsInside(t,s,e){return s>=t.x&&s<=t.right&&e>=t.y&&e<=t.bottom}}class i extends s{constructor(t,s,i,a,h){super(t,s,i,a,h),this.rect=new e(s,i,a,h)}}class a{constructor(){a.unloadedAssets=[],a.successCount=0,a.errorCount=0,a.cache={}}loadAsset(t){a.unloadedAssets.push(t)}loadAssets(t){0===a.unloadedAssets.length&&t();for(var s=0;s<a.unloadedAssets.length;s++){var e=a.unloadedAssets[s],i=new Image;i.addEventListener("load",function(){a.successCount+=1,a.isDone()&&t()},!1),i.addEventListener("error",function(){a.errorCount+=1,a.isDone()&&t()},!1),i.src=e,a.cache[e]=i}console.log(`${a.successCount}:${a.errorCount}`)}static isDone(){return a.unloadedAssets.length==a.successCount+a.errorCount}getAsset(t){return a.cache[t]}}class h extends s{constructor(t,s,i,a,h,n){super(t,s,i,a,h),this.id=n,this.rect=new e(s,i,a,h)}}class n{constructor(){this.tiles=[],this.width=0,this.totaltiles=0}generate(t,s){t.forEach((t,e)=>{this.width+=32,t.forEach((t,i)=>{this.totaltiles++;let a=null;t&&(0==t?a=new h(s.air,"Air",32*i,32*e,32,"none",t):1===t?a=new h(s.grass,"Grass",32*i,32*e,32,"foreground",t):2===t?a=new h(s.dirt,"Dirt",32*i,32*e,32,"foreground",t):3===t?a=new h(s.stone,"Stone",32*i,32*e,32,"foreground",t):4===t?a=new h(s.antimatter,"Antimatter",32*i,32*e,32,"unbreakable",t):5===t&&(a=new h(s.water,"Water",32*i,32*e,32,"spawn",t)),this.tiles.push(a))})}),this.height=this.totaltiles/this.width}}let o=new t;o.makeDisplay(window.innerWidth,window.innerHeight),t.useDisplay(o);let r,l,c=new class{constructor(){this.position={x:0,y:0},this.scale={x:1,y:1},this.left=0,this.top=0,this.right=0,this.bottom=0,this.width=0,this.height=0,this.distance=1e3,this.fov=Math.PI/4,this.aspectRatio=0,this.updateCamera()}startCamera(){ctx.save(),this.applyScale(),this.applyTranslation()}stopCamera(){ctx.restore()}applyScale(){ctx.scale(this.scale.x,this.scale.y)}applyTranslation(){ctx.translate(-this.left,-this.top)}updateCamera(){this.aspectRatio=canvas.width/canvas.height,this.width=this.distance*Math.tan(this.fov),this.height=this.width/this.aspectRatio,this.left=this.position.x-this.width/2,this.top=this.position.y-this.height/2,this.right=this.left+this.width,this.bottom=this.top+this.height,this.scale.x=canvas.width/this.width,this.scale.y=canvas.height/this.height}setZoomLevel(t){this.distance=t,this.updateCamera()}moveTo(t,s){this.position.x=t,this.position.y=s,this.updateCamera()}makeScreenCoordsWorldCoords(t,s){let e=[];return e[0]=t/this.scale.x+this.left,e[1]=s/this.scale.y+this.top,e}},d=new class{constructor(){this.actors=[]}draw(){for(let t in this.actors)ctx.drawImage(this.actors[t].image,this.actors[t].x,this.actors[t].y,this.actors[t].width,this.actors[t].height)}addActor(t){this.actors.push(t)}},g=new a,u=[],p=[];function w(){o.clearDisplay(),c.startCamera(),c.moveTo(l.tiles[2e3].x,l.tiles[2e3].y),c.setZoomLevel(2e3),d.draw(),c.stopCamera(),requestAnimationFrame(w)}g.loadAsset("/assets/ether.png"),g.loadAsset("/assets/tiles/air.png"),g.loadAsset("/assets/tiles/grass.png"),g.loadAsset("/assets/tiles/dirt.png"),g.loadAsset("/assets/tiles/stone.png"),g.loadAsset("/assets/tiles/antimatter.png"),g.loadAsset("/assets/tiles/water.png"),g.loadAssets(()=>{p.player=g.getAsset("/assets/ether.png"),p.air=g.getAsset("/assets/tiles/air.png"),p.grass=g.getAsset("/assets/tiles/grass.png"),p.dirt=g.getAsset("/assets/tiles/dirt.png"),p.stone=g.getAsset("/assets/tiles/stone.png"),p.antimatter=g.getAsset("/assets/tiles/antimatter.png"),p.water=g.getAsset("/assets/tiles/water.png"),function(){l=new n,function(){for(let t=0;t<60;t++){let t=[];if(u.length<=9)for(let s=0;s<60;s++)t.push(0);else if(10==u.length){for(let s=0;s<24;s++)t.push(1);t.push(5);for(let s=0;s<60;s++)t.push(0)}else if(11==u.length)for(let s=0;s<60;s++)t.push(1);else if(u.length<=25)for(let s=0;s<60;s++)t.push(2);else if(u.length<=50)for(let s=0;s<60;s++)t.push(3);else if(u.length<=60)for(let s=0;s<60;s++)t.push(4);u.push(t)}}(),l.generate(u,p),r=new i(p.player,0,0,32,32),d.addActor(r);for(let t=0;t<l.tiles.length;t++)d.addActor(l.tiles[t]);requestAnimationFrame(w)}()})}();
